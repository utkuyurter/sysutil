# sysutil
A PowerShell script that uses Sysinternals

Prerequisites:

  - Sysinternals

Usage:

  - .\sysutil.ps1

Options:

    - mode (Default=1): Test type to run.
        1 = List top memory consuming processes. Have the option to kill them
        2 = Scan running processes for Malware with VirusTotal
        3 = Compare Hash and file versions of running processes to previous hashes
        
    - outputFile (Default='.\out.log'): File to write the results.
    
    - excludeProcesses: File with process names that are ignored in scans.
    
    - hashInputFile: HASH file that was generated by the script.
        Note: By running mode=3 without this parameter, script will generate a hash file
        
    - sortType (Default=WS): Sort by type for memory usage.
        WS = Working Set (most recent physical memory usage (RAM))
        VM = Virtual Memory (physical + cached memory total)
        
     - numProcesses (Default=5): Number of most memory demanding processes to list
        Note: Used only on mode=1
        
Examples:

     .\sysutil -mode 1 -numProcesses 10 -sortType VM -outputFile top_processes.log
     .\sysutil -mode 2 -excludeProcesses excludedProcessList.txt -outputFile vtScanResults.log
     .\sysutil -mode 3 -hashInputFile hashes.txt
